{% extends 'dashboard.html' %}

{% block content %}
<div class="max-w-3xl mx-auto p-6 space-y-8 text-gray-200">

  <!-- ✅ Flash Message -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="space-y-2">
        {% for category, message in messages %}
          <div class="flex items-center gap-3 p-4 rounded-lg border shadow-sm
                      {% if category == 'success' %}
                        bg-green-900/40 text-green-300 border-green-700
                      {% elif category == 'danger' %}
                        bg-red-900/40 text-red-300 border-red-700
                      {% else %}
                        bg-gray-800 text-gray-300 border-gray-700
                      {% endif %}">
            <span class="font-medium">{{ message }}</span>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <!-- ✅ Card Utama -->
  <div class="bg-gray-900 p-6 rounded-xl shadow-md border border-gray-700 space-y-6">

    <h1 class="text-3xl font-bold text-white">Kelola Pengumuman Kos</h1>

    <!-- ✅ Form Tambah Pengumuman -->
    <form method="POST" action="{{ url_for('admin.pengumuman') }}" class="space-y-4">
    
      <div>
        <label for="judul" class="block font-semibold mb-1 text-gray-300">Judul Pengumuman</label>
        <input type="text" name="judul" id="judul"
               class="w-full border border-gray-700 bg-gray-800 text-gray-200 rounded-lg p-3
                      focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
               placeholder="Judul pengumuman...">
      </div>

      <div>
        <label for="isi" class="block font-semibold mb-1 text-gray-300">Isi Pengumuman</label>
        <textarea name="isi" id="isi" rows="3"
                  class="w-full border border-gray-700 bg-gray-800 text-gray-200 rounded-lg p-3
                         focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
                  placeholder="Tulis isi pengumuman..."></textarea>
      </div>

      <button type="submit"
        class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 font-semibold border border-green-700">
        Tambah Pengumuman
      </button>
    </form>

    <!-- ✅ Daftar Pengumuman -->
    <div class="space-y-3">
      <h2 class="text-xl font-semibold text-gray-200">Daftar Pengumuman</h2>

      <ul class="space-y-2 text-gray-300">
        {% for p in semua_pengumuman %}
          <li class="flex items-center justify-between bg-gray-800 p-3 rounded-lg hover:bg-gray-700 transition">
            <div class="flex flex-col">
              <span class="text-blue-400 font-semibold">{{ p.judul }}</span>
              <span>{{ p.isi }}</span>
              <span class="text-sm text-gray-400">
                Oleh: {{ p.pembuat.username if p.pembuat else 'Tidak diketahui' }}
              </span>
            </div>

            <div class="flex gap-3">
              <!-- Tombol Edit -->
              <a href="{{ url_for('admin.edit_pengumuman', id=p.id) }}"
                 class="text-yellow-400 hover:text-yellow-300 text-sm">Edit</a>

              <!-- Tombol Hapus -->
              <form method="POST" action="{{ url_for('admin.hapus_pengumuman', id=p.id) }}">
                <button onclick="return confirm('Yakin hapus pengumuman ini?')"
                        class="text-red-400 hover:text-red-300 text-sm">Hapus</button>
              </form>
            </div>
          </li>
        {% else %}
          <li class="text-gray-500 italic">Belum ada pengumuman.</li>
        {% endfor %}
      </ul>
    </div>

  </div>
</div>
{% endblock %}