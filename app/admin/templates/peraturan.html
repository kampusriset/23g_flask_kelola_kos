{% extends 'dashboard.html' %}

{% block content %}
<div class="max-w-3xl mx-auto p-6 space-y-8 text-gray-200">

  <!-- ✅ Flash Message -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="space-y-2">
        {% for category, message in messages %}
          <div class="flex items-center gap-3 p-4 rounded-lg border shadow-sm
                      {% if category == 'success' %}
                        bg-green-900/40 text-green-300 border-green-700
                      {% elif category == 'danger' %}
                        bg-red-900/40 text-red-300 border-red-700
                      {% else %}
                        bg-gray-800 text-gray-300 border-gray-700
                      {% endif %}">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M5 13l4 4L19 7" />
            </svg>
            <span class="font-medium">{{ message }}</span>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <!-- ✅ Card Utama -->
  <div class="bg-gray-900 p-6 rounded-xl shadow-md border border-gray-700 space-y-6">

    <h1 class="text-3xl font-bold text-white">Kelola Peraturan Kos</h1>

    <!-- ✅ Form Tambah Peraturan -->
    <form method="POST" class="space-y-4">
      {{ form.hidden_tag() }}
      <div>
        {{ form.isi.label(class="block font-semibold mb-1 text-gray-300") }}

        {{ form.isi(rows=3, class="w-full border border-gray-700 bg-gray-800 text-gray-200 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 transition", placeholder="Tulis peraturan baru...") }}
       
        {%  if form.isi.errors %}
          <p class="text-red-400 text-sm mt-1">
            {{ form.isi.errors[0] }}
          </p>
        {% endif %}
      </div>

      {{ form.submit(class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 font-semibold border border-green-700") }}
    </form>

    <!-- ✅ Daftar Peraturan -->
    <div class="space-y-3">
      <h2 class="text-xl font-semibold text-gray-200">Daftar Peraturan</h2>

      <ul class="space-y-2 text-gray-300">
        {% for p in semua_peraturan %}
          <li class="flex items-center justify-between hover:text-white transition">

            <div class="flex items-start gap-3">
              <span class="text-blue-400 font-semibold w-6">{{ loop.index }}.</span>
              <span>{{ p.isi }}</span>
            </div>

            <form method="POST" action="{{ url_for('admin.hapus_peraturan', id=p.id) }}">
              <button class="text-red-400 hover:text-red-300 text-sm">
                Hapus
              </button>
            </form>

          </li>
        {% else %}
          <li class="text-gray-500 italic">Belum ada peraturan.</li>
        {% endfor %}
      </ul>

    </div>

  </div>

</div>
{% endblock %}